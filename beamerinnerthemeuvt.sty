% SPDX-FileCopyrightText: 2023 Alexandru Fikl <alexfikl@gmail.com>
% SPDX-License-Identifier: CC-BY-SA-4.0

\def\fileversion{v0.1}
\def\filedate{2023/12/21}

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamerinnerthemeuvt}[\filedate \fileversion UVT Beamer Inner Theme]

% <<< templates

\setbeamertemplate{background}[uvtslide]

\NewDocumentCommand \titleframe {} {
    \setbeamertemplate{title page}[uvttitlepage]
    \setbeamertemplate{background}[uvttitlepage]
    \frame[plain,noframenumbering]{\titlepage}
    \setbeamertemplate{background}[uvtslide]
}

\NewDocumentCommand \sectionframe {} {
    \setbeamertemplate{section page}[uvtsectionpage]
    \setbeamertemplate{background}[uvttitlepage]
    \frame[plain,noframenumbering]{\sectionpage}
    \setbeamertemplate{background}[uvtslide]
}
\AtBeginSection{
    \sectionframe
}

% >>>

% <<< styles

\defbeamertemplate{title page}{uvttitlepage}
{
    \vfill
    \begin{center}
        % title format
        \usebeamerfont{title}\usebeamercolor[fg]{title}
        \inserttitle\par
        % subtitle
        \usebeamerfont{subtitle}\insertsubtitle\par%
        \bigskip
        % author
        \usebeamerfont{author}\insertauthor\par%
        \bigskip
        \usebeamerfont{date}\insertdate%
    \end{center}
}

\defbeamertemplate{section page}{uvtsectionpage}
{
    \vskip40pt
    \begin{center}
        \begin{minipage}[t][][c]{\textwidth}%
            \centering
            \usebeamerfont{section title}\usebeamercolor[fg]{section}
            \insertsectionhead\par
        \end{minipage}
    \end{center}
    \vfill
}

% <<< background

\defbeamertemplate{background}{uvttitlepage}
{
    \begin{tikzpicture}[remember picture, overlay]
        \node [shading=axis,
               rectangle,
               left color=UVTDarkBlue,
               right color=UVTLightBlue,
               shading angle=45,
               anchor=north,
               minimum width=\paperwidth, minimum height=\paperheight]
               (box) at (current page.north) {};
        \node [opacity=0.5] at (current page.center)
            {\includegraphics[width=0.4\paperwidth]{assets/uvt-background-logo-white}};
    \end{tikzpicture}
}

\defbeamertemplate{background}{uvtslide}{
    \begin{tikzpicture}[remember picture, overlay]
        \node [opacity=0.01] at (current page.center)
            {\includegraphics[width=0.4\paperwidth]{assets/uvt-background-logo-black}};
    \end{tikzpicture}
}

% >>>

% <<< itemize / enumerate

\setbeamertemplate{itemize item}{
    \tikz{
        \draw[fill=UVTOrange, draw=none] (0, 0) rectangle (0.1, 0.1);
        \draw[fill=UVTOrange, draw=none] (0.1, 0.1) rectangle (0.2, 0.2);
        \draw[fill=UVTOrange, draw=none] (0, 0.2) rectangle (0.1, 0.3);
    }
}

\setbeamertemplate{itemize subitem}{
    \tikz{
        \draw[fill=UVTDarkBlue, draw=none] (0, 0) rectangle (0.075, 0.075);
        \draw[fill=UVTDarkBlue, draw=none] (0.075, 0.075) rectangle (0.15, 0.15);
        \draw[fill=UVTDarkBlue, draw=none] (0, 0.15) rectangle (0.075, 0.225);
    }
}

\setbeamertemplate{itemize subsubitem}{
    \tikz{
        \draw[fill=white, draw=none] (0, 0) rectangle (0.075, 0.075);
        \draw[fill=UVTLightBlue, draw=none] (0.075, 0.075) rectangle (0.15, 0.15);
        \draw[fill=white, draw=none] (0, 0.15) rectangle (0.075, 0.225);
    }
}

% >>>

% <<< blocks

\setbeamertemplate{block begin}{
    \vspace{\fill}
    \begin{adjustbox}{max width=0.98\textwidth, trim=0 2ex 0 0,clip}
        \begin{tabular}{!{\color{UVTDarkBlue}{\vrule width 4pt}}>{\columncolor[gray]{0.97}}m{\textwidth}}
    	    \begin{beamercolorbox}{block title}
                \usebeamerfont*{block title}
                \vbox{}\vskip 0.2ex
                \insertblocktitle
            \end{beamercolorbox}
            \usebeamerfont*{block text}
}
\setbeamertemplate{block end}{\end{tabular}\end{adjustbox}}

\setbeamertemplate{block alerted begin}{
    \vspace{\fill}
    \begin{adjustbox}{max width=0.98\textwidth, trim=0 2ex 0 0,clip}
        \begin{tabular}{!{\color{UVTOrange}{\vrule width 4pt}}>{\columncolor[gray]{0.97}}m{\textwidth}}
    	    \begin{beamercolorbox}{alerted text}
                \usebeamerfont*{block title}
                \vbox{}\vskip 0.2ex
                \insertblocktitle
            \end{beamercolorbox}
            \usebeamerfont*{block text}
}
\setbeamertemplate{block alerted end}{\end{tabular}\end{adjustbox}}

\setbeamertemplate{block example begin}{
    \vspace{\fill}
    \begin{adjustbox}{max width=0.98\textwidth, trim=0 2ex 0 0,clip}
        \begin{tabular}{!{\color{UVTLightBlue}{\vrule width 4pt}}>{\columncolor[gray]{0.97}}m{\textwidth}}
    	    \begin{beamercolorbox}{example text}
                \usebeamerfont*{block title}
                \vbox{}\vskip 0.2ex
                \insertblocktitle
            \end{beamercolorbox}
            \usebeamerfont*{block text}
}
\setbeamertemplate{block example end}{\end{tabular}\end{adjustbox}}

% >>>

% <<< figures

% % disable "Figure:" in the captions
% \setbeamertemplate{caption}{\tiny\insertcaption}
% \setbeamertemplate{caption label separator}{}

% >>>

% >>>

%% vim: foldmarker=<<<,>>>:foldmethod=marker:nospell:filetype=tex
